{
	"name": "Misc - Kill All Inactive Sessions",
	"properties": {
		"content": {
			"query": "USE master;\nGO\n\n-- CREATE PROCEDURE dbo.KillInactiveSessions\n-- AS\nDECLARE @user_spid INT\nDECLARE CurSPID CURSOR FAST_FORWARD\nFOR\nSELECT SPID\nFROM master.dbo.sysprocesses (NOLOCK)\nWHERE spid>50 -- avoid system threads\nAND status='sleeping' -- only sleeping threads\nAND DATEDIFF(HOUR,last_batch,GETDATE())>=1 -- thread sleeping for 1 hours\nAND spid<>@@spid -- ignore current spid\nOPEN CurSPID\nFETCH NEXT FROM CurSPID INTO @user_spid\nWHILE (@@FETCH_STATUS=0)\nBEGIN\nPRINT 'Killing '+CONVERT(VARCHAR,@user_spid)\nEXEC('KILL '+@user_spid)\nFETCH NEXT FROM CurSPID INTO @user_spid\nEND\nCLOSE CurSPID\nDEALLOCATE CurSPID\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "small",
				"databaseName": "master"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}